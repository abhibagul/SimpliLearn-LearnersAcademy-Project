<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
	<%@page import="java.sql.DriverManager"%>
	<%@page import="java.sql.ResultSet"%>
	<%@page import="java.sql.Statement"%>
	<%@page import="java.sql.Connection"%>
	<%
		String session_u_name = (String)session.getAttribute("usname");
		String role = (String)session.getAttribute("role");	
	
		if(role != "admin"){
			response.sendRedirect("admin.jsp");
		}
		
		String driverName = "com.mysql.jdbc.Driver";
		String connectionUrl = "jdbc:mysql://localhost:3306/";
		String dbName = "learnersacademy";
		String userId = "root";
		String password = "root12345";
		
		
		String action = (String) request.getParameter("action");
%>

<main>
	<jsp:include page="sidebarComp.jsp"/>

	<div class="data">
	
	<jsp:include page="headerComp.jsp"/>
  
	
	<div class="p-3 control">


	<h4>Manage Classes Page</h4>
	
	
  
  
  	<div class="my-3 p-3 bg-body rounded shadow-sm">
		<form id="stdSelector" action="manageClasses.jsp" method="get"  class="row g-3">
  <div class="col-lg-3 col-md-6 ">
    <label for="standardSelector" class="form-label">Select Standard : </label>
    <input type="hidden" name="page" value="">
    <input type="hidden" name="action" value="classSelector">
	<select class="form-control" onchange="document.getElementById('stdSelector').submit()" name="selectedStd"  id="standardSelector">
	<option>Select Standard</option>
	<%
	
		try {
			Class.forName(driverName);
		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		}
	
		Connection connection = null;
		Statement statement = null;
		ResultSet resultSet = null;
	
		try{
			
			connection = DriverManager.getConnection(connectionUrl+dbName, userId, password);
			statement=connection.createStatement();
			String sql ="SELECT DISTINCT std FROM class";

			resultSet = statement.executeQuery(sql);
			
			while(resultSet.next()){
				%>
				<option value="<%=resultSet.getString("std") %>" <% if(action != null && action=="classSelector" && resultSet.getString("std") == (String)request.getParameter("action")){ %> selected="selected" <% } %>><%=resultSet.getString("std") %></option>
				<%
			}

			
		}catch(Exception e){
			e.printStackTrace();
		}
	
	%>
	
	</select>
  </div>
  </form>
	</div>
	
	
	<div class="my-3 p-3 bg-body rounded shadow-sm">
		<%
			if(action != null && action == "classSelector" ){
				
				if(action == "classSelector"){
					connection = DriverManager.getConnection(connectionUrl+dbName, userId, password);
					statement=connection.createStatement();
					String sql ="SELECT std FROM class where std=?";
					
				}
				
				
			}else{
				%>
				
				<h4 class="text-center">Please select the standard from above list.</h4>
				
				<%
			}
		%>
	</div>
	
	</div>
	<!-- /main content -->
	</div>
	
	</main>

</body>
</html>